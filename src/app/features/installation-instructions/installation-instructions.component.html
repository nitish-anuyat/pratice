<div class="container installation page-padding-top-medium">
    <app-page-title [title]=" (isManual ? 'installation.manual': 'installation.qr') | translate"></app-page-title>
    <div class="page-details-card mx-auto mb-1">
        <div class="row">
            <div class="col-md-12">
                <div class="card shadow-card"></div>
                <div class="card">
                    <div class="card-body py-4 px-2 mx-3 h-auto">
                        <div class="row qr-title-section">
                            <div class="col-12 col-md-12 col-lg-6">
                                <h3>{{ (isManual ? 'installation.manual_instructions' : 'installation.qr_instructions') | translate}}</h3>
                                <h5>{{ 'installation.selection_message' | translate }}</h5>
                                <h5>{{ 'installation.selection_details' | translate }}</h5>
                            </div>
                            <div class="col-12 col-md-12 col-lg-6 radio-main-div p-0 mt-md-3 mt-lg-0">
                                <div class="d-flex justify-content-between radio-div" [class.active]="!isManual" (click)="isManual = false; instructions('qr')">
                                    <label for="">{{ 'installation.qr' | translate }} </label>
                                    <input type="radio" name="installationType" value="false" [checked]="!isManual">
                                </div>
                                <div class="d-flex justify-content-between radio-div" [class.active]="isManual" (click)="isManual = true; instructions('manual')">
                                    <label for="">{{ 'installation.manual' | translate }}</label>
                                    <input type="radio" name="installationType" value="true" [checked]="isManual">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row mt-4 instructions-row">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-body py-4 mx-2 h-auto mx-md-4 pb-md-0">
                        <div class="sf-pro-regular border rounded-3 w-50 p-2 mb-3 mt-md-4 mx-remove-gutter">
                            <ul class="nav nav-pills nav-justified" id="pills-tab" role="tablist">
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link active rounded-3" id="pills-home-tab" data-bs-toggle="pill" data-bs-target="#pills-home" type="button" role="tab" aria-controls="pills-home" aria-selected="true" (click)="isAndroid = false; selectDevice('ios')">iOS</button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link rounded-3" id="pills-profile-tab" data-bs-toggle="pill" data-bs-target="#pills-profile" type="button" role="tab" aria-controls="pills-profile" aria-selected="false" (click)="isAndroid = true; selectDevice('android')">Android</button>
                                </li>
                            </ul>
                        </div>
                        <div class="row content-row">
                            <h3 class="qr-heading order-first d-block d-lg-none pe-5 pe-md-0 mb-3 mb-md-0 mx-remove-gutter">{{ 'installation.detail_instruction' | translate:{ device: isAndroid ? 'Android': 'iOS' } }}</h3>
                            <div class="col-12 col-md-7 col-lg-8">
                                <h3 class="qr-heading order-first d-none d-md-none d-lg-block">{{ 'installation.detail_instruction' | translate:{ device: isAndroid ? 'Android': 'iOS' } }}</h3>
                                <div class="row py-4 p-lg-4 px-md-0 pt-md-0 mt-lg-high">
                                    <div class="col-12 col-md-12 col-lg-6 px-4 px-md-2">
                                        <ul class="steps">
                                            <li class="step-li d-flex" *ngFor="let stepBtn of stepsButtonArr; let i=index" [ngClass]="[selectedValue === i ? 'step-checked' : '']" (click)="selectedValue=i">
                                                <span>
                                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14" fill="none" class="svg-bullet">
                                                        <circle cx="7" cy="7" r="7" fill="#6365EF"/>
                                                    </svg>
                                                </span>
                                                <span class="step-label">{{stepBtn.label | translate }}</span>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="col-12 col-md-12 col-lg-6 radio-main-div p-0 position-relative text-center image-description-section mt-4 mt-md-0">
                                        <ng-container [ngSwitch]="selectedValue">
                                            <ng-container *ngFor="let step of stepsImageArr; let i=index">
                                                <ng-container *ngSwitchCase="i">
                                                    <img [src]="step.imageUrl" alt="step1" class="steps-image">
                                                    <div class="description d-flex" [class]="step.cssClass">
                                                        <span class="number-span">
                                                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="none">
                                                                <circle cx="10" cy="10" r="10" fill="#6365EF"/>
                                                            </svg>
                                                            <span class="number">{{ i+1 }}</span>
                                                        </span>
                                                        <span class="step-description" [innerHTML]="step.description | translate "></span>
                                                    </div>
                                                    <div class="d-lg-none d-md-none d-block" style="clear: both"></div>
                                                    <span class="sf-pro-regular d-flex justify-content-around justify-content-md-between d-block d-md-none mobile-btn-section mt-3">
                                                        <button type="button" class="btn installation-btn" (click)="goToHome()">{{ 'installation.skip' | translate }}</button>
                                                        <button type="button" class="btn activate-btn ms-2" (click)="continue()">{{ 'installation.continue' | translate }}</button>
                                                    </span>
                                                </ng-container>
                                            </ng-container>
                                        </ng-container>
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 col-md-5 col-lg-4 d-flex flex-column flex-md-column justify-content-between order-first order-md-last tablet"  *ngIf="!inProgress">
                                <div class="first text-center d-flex flex-column justify-content-between mx-remove-gutter" [class.manual-view]="isManual">
                                    <div id="qrCanvasSection">
                                        <qrcode
                                            #parent
                                            [qrdata]="activationCodeForQR"
                                            [allowEmptyString]="true"
                                            cssClass="center qr-canvas"
                                            elementType="canvas"
                                            errorCorrectionLevel="H"
                                            [imageSrc]="'assets/images/auth/gb-small-new.jpg'"
                                            [imageHeight]="100"
                                            [imageWidth]="100"
                                            [scale]="1"
                                            [title]=" 'installation.scan_qr' | translate "
                                            [width]="300"
                                            [margin]="2"
                                            *ngIf="!isManual" 
                                            (qrCodeURL)="onChangeURL($event)" 
                                        ></qrcode>
                                        <div *ngIf="isManual && !isAndroid">
                                            <div class="d-flex justify-content-between radio-div">
                                                <div>
                                                    <h3>{{ 'installation.sm_dp_address' | translate }}</h3>
                                                    <h5>{{ smdpAddress }}</h5>
                                                </div>
                                                <div>
                                                    <svg class="copy" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" fill="none" (click)="copyToClipboard($event,smdpAddress)" [tooltip]="copyText" placement="top" delay="100" offset="10">
                                                        <mask id="mask0_60_46722" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="28" height="28">
                                                            <rect width="28" height="28" fill="#D9D9D9"/>
                                                        </mask>
                                                        <g mask="url(#mask0_60_46722)">
                                                            <path d="M22.1693 22.1563H9.33594C8.69427 22.1563 8.14516 21.928 7.6886 21.4714C7.23127 21.0141 7.0026 20.4646 7.0026 19.8229V3.48958C7.0026 2.84792 7.23127 2.29842 7.6886 1.84108C8.14516 1.38453 8.69427 1.15625 9.33594 1.15625H17.5026L24.5026 8.15625V19.8229C24.5026 20.4646 24.2743 21.0141 23.8178 21.4714C23.3604 21.928 22.8109 22.1563 22.1693 22.1563ZM16.3359 9.32292V3.48958H9.33594V19.8229H22.1693V9.32292H16.3359ZM4.66927 26.8229C4.0276 26.8229 3.47849 26.5946 3.02194 26.1381C2.5646 25.6808 2.33594 25.1313 2.33594 24.4896V8.15625H4.66927V24.4896H17.5026V26.8229H4.66927Z" fill="#6365EF"/>
                                                        </g>
                                                    </svg>
                                                </div>
                                            </div>
                                            <div class="d-flex justify-content-between radio-div">
                                                <div class="w80">
                                                    <h3>{{ 'installation.activation_code' | translate }}</h3>
                                                    <h5 class="text-wrap">{{ activationCode }}</h5>
                                                </div>
                                                <div>
                                                    <svg class="copy" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" fill="none" (click)="copyToClipboard($event,activationCode)" [tooltip]="copyText" placement="top" delay="100" offset="10">
                                                        <mask id="mask0_60_46722" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="28" height="28">
                                                            <rect width="28" height="28" fill="#D9D9D9"/>
                                                        </mask>
                                                        <g mask="url(#mask0_60_46722)">
                                                            <path d="M22.1693 22.1563H9.33594C8.69427 22.1563 8.14516 21.928 7.6886 21.4714C7.23127 21.0141 7.0026 20.4646 7.0026 19.8229V3.48958C7.0026 2.84792 7.23127 2.29842 7.6886 1.84108C8.14516 1.38453 8.69427 1.15625 9.33594 1.15625H17.5026L24.5026 8.15625V19.8229C24.5026 20.4646 24.2743 21.0141 23.8178 21.4714C23.3604 21.928 22.8109 22.1563 22.1693 22.1563ZM16.3359 9.32292V3.48958H9.33594V19.8229H22.1693V9.32292H16.3359ZM4.66927 26.8229C4.0276 26.8229 3.47849 26.5946 3.02194 26.1381C2.5646 25.6808 2.33594 25.1313 2.33594 24.4896V8.15625H4.66927V24.4896H17.5026V26.8229H4.66927Z" fill="#6365EF"/>
                                                        </g>
                                                    </svg>
                                                </div>
                                            </div>
                                        </div>
                                        <div *ngIf="isManual && isAndroid">
                                            <div class="d-flex justify-content-between radio-div mt-2 android-code" [ngClass]="{'border-round': (isManual && isAndroid)}">
                                                <div class="w80">
                                                    <h3>{{ 'installation.lpa_string' | translate }}</h3>
                                                    <h5 class="text-wrap">{{ activationCodeForQR }}</h5>
                                                </div>
                                                <div>
                                                    <svg class="copy" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" fill="none" (click)="copyToClipboard($event,activationCodeForQR)" [tooltip]="copyText" placement="top" delay="100" offset="10">
                                                        <mask id="mask0_60_46722" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="28" height="28">
                                                            <rect width="28" height="28" fill="#D9D9D9"/>
                                                        </mask>
                                                        <g mask="url(#mask0_60_46722)">
                                                            <path d="M22.1693 22.1563H9.33594C8.69427 22.1563 8.14516 21.928 7.6886 21.4714C7.23127 21.0141 7.0026 20.4646 7.0026 19.8229V3.48958C7.0026 2.84792 7.23127 2.29842 7.6886 1.84108C8.14516 1.38453 8.69427 1.15625 9.33594 1.15625H17.5026L24.5026 8.15625V19.8229C24.5026 20.4646 24.2743 21.0141 23.8178 21.4714C23.3604 21.928 22.8109 22.1563 22.1693 22.1563ZM16.3359 9.32292V3.48958H9.33594V19.8229H22.1693V9.32292H16.3359ZM4.66927 26.8229C4.0276 26.8229 3.47849 26.5946 3.02194 26.1381C2.5646 25.6808 2.33594 25.1313 2.33594 24.4896V8.15625H4.66927V24.4896H17.5026V26.8229H4.66927Z" fill="#6365EF"/>
                                                        </g>
                                                    </svg>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="sf-pro-regular d-flex justify-content-around d-none d-md-flex web-button">
                                        <button type="button" class="btn installation-btn" (click)="goToHome()">{{ 'installation.skip' | translate }}</button>
                                        <button type="button" class="btn activate-btn" (click)="continue()">{{ 'installation.continue' | translate }}</button>
                                    </div>
                                </div>
                                <div class="second d-flex justify-content-around mt-3 pt-3 mt-md-0 pt-md-0 d-lg-none" *ngIf="!isManual">
                                    <button type="button" class="btn installation-btn" (click)="sendEmailQRCode()">
                                        {{ 'installation.email_qr' | translate}} &nbsp;                                        
                                        <svg viewBox="0 0 21 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M10 9L2 4V14H11V16H2C1.45 16 0.979167 15.8042 0.5875 15.4125C0.195833 15.0208 0 14.55 0 14V2C0 1.45 0.195833 0.979167 0.5875 0.5875C0.979167 0.195833 1.45 0 2 0H18C18.55 0 19.0208 0.195833 19.4125 0.5875C19.8042 0.979167 20 1.45 20 2V9H18V4L10 9ZM10 7L18 2H2L10 7ZM17 19L15.6 17.6L17.175 16H13V14H17.175L15.575 12.4L17 11L21 15L17 19ZM2 4V15V9V9.075V2V4Z" fill="#6365EF"/>
                                        </svg>
                                    </button>
                                    <a class="btn installation-btn ms-2" [href]="qrCodeDownloadLink" download="qrcode" (click)="downloadQRCode()">
                                        {{ 'installation.download_qr' | translate}} &nbsp;
                                        <svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M2 16C1.45 16 0.979167 15.8042 0.5875 15.4125C0.195833 15.0208 0 14.55 0 14V11H2V14H14V11H16V14C16 14.55 15.8042 15.0208 15.4125 15.4125C15.0208 15.8042 14.55 16 14 16H2ZM8 12L3 7L4.4 5.55L7 8.15V0H9V8.15L11.6 5.55L13 7L8 12Z" fill="#6365EF"/>
                                        </svg>    
                                    </a>
                                </div>
                            </div>
                            <div class="w-auto mx-auto order-first order-md-first order-lg-last" *ngIf="inProgress">
                                <app-loader></app-loader>
                            </div>
                        </div>
                        <div class="row button-section d-none d-lg-flex" [ngClass]="{ 'spacing-for-android': isAndroid || isManual}">
                            <div class="ms-auto col-md-6 col-lg-4 tablet">
                                <div class="second d-flex justify-content-around mt-3 pt-3 my-md-3 py-md-3 mb-lg-0 pb-lg-0" *ngIf="!isManual">
                                    <button type="button" class="btn installation-btn" (click)="sendEmailQRCode()">
                                        {{ 'installation.email_qr' | translate}} &nbsp;                                        
                                        <svg viewBox="0 0 21 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M10 9L2 4V14H11V16H2C1.45 16 0.979167 15.8042 0.5875 15.4125C0.195833 15.0208 0 14.55 0 14V2C0 1.45 0.195833 0.979167 0.5875 0.5875C0.979167 0.195833 1.45 0 2 0H18C18.55 0 19.0208 0.195833 19.4125 0.5875C19.8042 0.979167 20 1.45 20 2V9H18V4L10 9ZM10 7L18 2H2L10 7ZM17 19L15.6 17.6L17.175 16H13V14H17.175L15.575 12.4L17 11L21 15L17 19ZM2 4V15V9V9.075V2V4Z" fill="#6365EF"/>
                                        </svg>
                                    </button>
                                    <a class="btn installation-btn ms-2" [href]="qrCodeDownloadLink" download="qrcode" (click)="downloadQRCode()">
                                        {{ 'installation.download_qr' | translate}} &nbsp;
                                        <svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M2 16C1.45 16 0.979167 15.8042 0.5875 15.4125C0.195833 15.0208 0 14.55 0 14V11H2V14H14V11H16V14C16 14.55 15.8042 15.0208 15.4125 15.4125C15.0208 15.8042 14.55 16 14 16H2ZM8 12L3 7L4.4 5.55L7 8.15V0H9V8.15L11.6 5.55L13 7L8 12Z" fill="#6365EF"/>
                                        </svg>    
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>